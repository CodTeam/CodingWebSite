<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <meta name="renderer" content="webkit"/>
    <title>Coding一下，bug 解决</title>


    <link href="/static/css/bootstrapv3.css" rel="stylesheet"/>
    <script src="/static/js/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script src="/static/js/bootstrapv3.js" type="text/javascript"></script>
    <link href="/static/css/style.css" rel="stylesheet"/>
    <link href="/static/css/searchResult.css" rel="stylesheet">


</head>
<body>
<!--<div style="margin: 100px 0 0 0;"></div>-->
<div class="wrap">
    <!--顶部-->
    <div id="head">

        <div class="top-head">
            <div class="logo"><a href="/"><span>Coding.So</span></a></div>
            <div class="srh">
                <div class="srh-box">
                    <input id="txtsearch_box" type="text" placeholder="输入框">
                    <span class="srh-video"></span>
                    <span id="btn_search" class="srh-btn"></span>
                </div>
            </div>
            <div class="top-head-right f_r">
                <a href="/json">Tools</a>

                <button>登录</button>
            </div>
        </div>

        <div class="top-nav">
            <a href="#" class="active">全部</a>
            <!--<a href="#">图片</a>-->
            <!--<a href="#">视频</a>-->
            <!--<a href="#">新闻</a>-->
            <!--<a href="#">地图</a>-->
            <!--<a href="#">更多</a>-->
            <!---->
            <!--<a href="#" style="float: right;">工具</a>-->
            <!--<a href="#" style="float: right;">设置</a>-->
        </div>
    </div>


    <!--列表-->
    <div class="list">
        <div class="list-data">
            <p>找到约<span id="res_total_count"></span>条结果（最高匹配度<span id="res_max_score"></span>分）</p>
        </div>
        <!--搜索结果列表-->
        <div class="srh-list">
            <div class="srh-list-data">
                <div class="srh-list-data-body">

                    <!--<div class="list-data-show">-->
                    <!--<h3><a href="#">Online tests and testing software | Test.com</a></h3>-->

                    <!--<div class="list-address">-->
                    <!--<cite class="adr">https://www.<b>test</b>.com/</cite>-->
                    <!--<div class="list-arrow">-->
                    <!--<a href="#">-->
                    <!--<span></span>-->
                    <!--</a>-->
                    <!--</div>-->
                    <!--<a class="trs" href="#">翻译此页</a>-->
                    <!--</div>-->

                    <!--<span class="abs">Online <em>tests</em> and testing for certification, practice <em>tests</em>, <em>test</em> making tools, medical testing and more.</span>-->

                    <!--</div>-->

                    <!--<div class="list-data-show">-->
                    <!--<h3><a href="#">Online tests and testing software | Test.com</a></h3>-->

                    <!--<div class="list-address">-->
                    <!--<cite class="adr">https://www.<b>test</b>.com/</cite>-->
                    <!--<div class="list-arrow">-->
                    <!--<a href="#">-->
                    <!--<span></span>-->
                    <!--</a>-->
                    <!--</div>-->
                    <!--<a class="trs" href="#">翻译此页</a>-->
                    <!--</div>-->

                    <!--<span class="abs">Online <em>tests</em> and testing for certification, practice <em>tests</em>, <em>test</em> making tools, medical testing and more.</span>-->

                    <!--</div>-->

                    <!--<div class="list-data-show">-->
                    <!--<h3><a href="#">Online tests and testing software | Test.com</a></h3>-->

                    <!--<div class="list-address">-->
                    <!--<cite class="adr">https://www.<b>test</b>.com/</cite>-->
                    <!--<div class="list-arrow">-->
                    <!--<a href="#">-->
                    <!--<span></span>-->
                    <!--</a>-->
                    <!--</div>-->
                    <!--<a class="trs" href="#">翻译此页</a>-->
                    <!--</div>-->

                    <!--<span class="abs">Online <em>tests</em> and testing for certification, practice <em>tests</em>, <em>test</em> making tools, medical testing and more.</span>-->

                    <!--</div>-->

                    <!--<div class="list-data-show">-->
                    <!--<h3><a href="#">Online tests and testing software | Test.com</a></h3>-->

                    <!--<div class="list-address">-->
                    <!--<cite class="adr">https://www.<b>test</b>.com/</cite>-->
                    <!--<div class="list-arrow">-->
                    <!--<a href="#">-->
                    <!--<span></span>-->
                    <!--</a>-->
                    <!--</div>-->
                    <!--<a class="trs" href="#">翻译此页</a>-->
                    <!--</div>-->

                    <!--<span class="abs">Online <em>tests</em> and testing for certification, practice <em>tests</em>, <em>test</em> making tools, medical testing and more.</span>-->

                    <!--</div>-->

                    <!--<div class="list-data-show">-->
                    <!--<h3><a href="#">Online tests and testing software | Test.com</a></h3>-->

                    <!--<div class="list-address">-->
                    <!--<cite class="adr">https://www.<b>test</b>.com/</cite>-->
                    <!--<div class="list-arrow">-->
                    <!--<a href="#">-->
                    <!--<span></span>-->
                    <!--</a>-->
                    <!--</div>-->
                    <!--<a class="trs" href="#">翻译此页</a>-->
                    <!--</div>-->

                    <!--<span class="abs">Online <em>tests</em> and testing for certification, practice <em>tests</em>, <em>test</em> making tools, medical testing and more.</span>-->

                    <!--</div>-->

                    <!--<div class="list-data-show">-->
                    <!--<h3><a href="#">Online tests and testing software | Test.com</a></h3>-->

                    <!--<div class="list-address">-->
                    <!--<cite class="adr">https://www.<b>test</b>.com/</cite>-->
                    <!--<div class="list-arrow">-->
                    <!--<a href="#">-->
                    <!--<span></span>-->
                    <!--</a>-->
                    <!--</div>-->
                    <!--<a class="trs" href="#">翻译此页</a>-->
                    <!--</div>-->

                    <!--<span class="abs">Online <em>tests</em> and testing for certification, practice <em>tests</em>, <em>test</em> making tools, medical testing and more.</span>-->

                    <!--</div>-->

                    <!--<div class="list-data-show">-->
                    <!--<h3><a href="#">Online tests and testing software | Test.com</a></h3>-->

                    <!--<div class="list-address">-->
                    <!--<cite class="adr">https://www.<b>test</b>.com/</cite>-->
                    <!--<div class="list-arrow">-->
                    <!--<a href="#">-->
                    <!--<span></span>-->
                    <!--</a>-->
                    <!--</div>-->
                    <!--<a class="trs" href="#">翻译此页</a>-->
                    <!--</div>-->

                    <!--<span class="abs">Online <em>tests</em> and testing for certification, practice <em>tests</em>, <em>test</em> making tools, medical testing and more.</span>-->

                    <!--</div>-->

                    <!--<div class="list-data-show">-->
                    <!--<h3><a href="#">Online tests and testing software | Test.com</a></h3>-->

                    <!--<div class="list-address">-->
                    <!--<cite class="adr">https://www.<b>test</b>.com/</cite>-->
                    <!--<div class="list-arrow">-->
                    <!--<a href="#">-->
                    <!--<span></span>-->
                    <!--</a>-->
                    <!--</div>-->
                    <!--<a class="trs" href="#">翻译此页</a>-->
                    <!--</div>-->

                    <!--<span class="abs">Online <em>tests</em> and testing for certification, practice <em>tests</em>, <em>test</em> making tools, medical testing and more.</span>-->

                    <!--</div>-->

                    <!--<div class="list-data-show">-->
                    <!--<h3><a href="#">Online tests and testing software | Test.com</a></h3>-->

                    <!--<div class="list-address">-->
                    <!--<cite class="adr">https://www.<b>test</b>.com/</cite>-->
                    <!--<div class="list-arrow">-->
                    <!--<a href="#">-->
                    <!--<span></span>-->
                    <!--</a>-->
                    <!--</div>-->
                    <!--<a class="trs" href="#">翻译此页</a>-->
                    <!--</div>-->

                    <!--<span class="abs">Online <em>tests</em> and testing for certification, practice <em>tests</em>, <em>test</em> making tools, medical testing and more.</span>-->

                    <!--</div>-->

                    <!--<div class="list-data-show">-->
                    <!--<h3><a href="#">Online tests and testing software | Test.com</a></h3>-->

                    <!--<div class="list-address">-->
                    <!--<cite class="adr">https://www.<b>test</b>.com/</cite>-->
                    <!--<div class="list-arrow">-->
                    <!--<a href="#">-->
                    <!--<span></span>-->
                    <!--</a>-->
                    <!--</div>-->
                    <!--<a class="trs" href="#">翻译此页</a>-->
                    <!--</div>-->

                    <!--<span class="abs">Online <em>tests</em> and testing for certification, practice <em>tests</em>, <em>test</em> making tools, medical testing and more.</span>-->

                    <!--</div>-->
                </div>


                <!--相关搜索结果-->
                <!--<div class="relat-data">-->
                    <!--<div class="_ojo">-->
                        <!--<h3 class="med _wI" style="text-align:left">相关搜索</h3>-->
                    <!--</div>-->
                    <!--<div class="r-show">-->
                        <!--<div class="r-s-list">-->
                            <!--<p>-->
                                <!--<a href="#">ip</a>-->
                            <!--</p>-->
                            <!--<p>-->
                                <!--<a href="#">rrrrrrr</a>-->
                            <!--</p>-->
                            <!--<p>-->
                                <!--<a href="#">zjeshoiw</a>-->
                            <!--</p>-->
                            <!--<p>-->
                                <!--<a href="#">tbggv brr</a>-->
                            <!--</p>-->
                            <!--<p>-->
                                <!--<a href="#">sawwafdfsef</a>-->
                            <!--</p>-->
                        <!--</div>-->

                        <!--<div class="r-s-list">-->
                            <!--<p>-->
                                <!--<a href="#">ip</a>-->
                            <!--</p>-->
                            <!--<p>-->
                                <!--<a href="#">rrrrrrr</a>-->
                            <!--</p>-->
                            <!--<p>-->
                                <!--<a href="#">zjeshoiw</a>-->
                            <!--</p>-->
                            <!--<p>-->
                                <!--<a href="#">tbggv brr</a>-->
                            <!--</p>-->
                            <!--<p>-->
                                <!--<a href="#">sawwafdfsef</a>-->
                            <!--</p>-->
                        <!--</div>-->

                    <!--</div>-->
                <!--</div>-->

                <!--翻页导航-->
                <div class="container">
                    <ul id="page-navigation">


                        <!--<nav aria-label="Page navigation">-->
                        <!--<ul class="pagination">-->
                        <!--<li><a href="#">Previous</a></li>-->
                        <!--<li class="active">-->
                        <!--<a href="#">1</a>-->
                        <!--</li>-->
                        <!--<li>-->
                        <!--<a href="#">2</a>-->
                        <!--</li>-->
                        <!--<li>-->
                        <!--<a href="#">3</a>-->
                        <!--</li>-->
                        <!--<li>-->
                        <!--<a href="#">4</a>-->
                        <!--</li>-->
                        <!--<li>-->
                        <!--<a href="#">5</a>-->
                        <!--</li>-->
                        <!--<li><a href="#">Next</a></li>-->
                        <!--</ul>-->
                        <!--</nav>-->
                    </ul>
                </div>

            </div>
        </div>
    </div>


    <!--底部-->
    <div class="foot">
        <div class="f-c">
            <div class="_HR" style="visibility: visible;" id="swml">
                <div class="_uIb">
                    <span class="unknown_loc"></span>
                    <span id="swml_addr">未知</span> -
                    <a href="#">使用确切位置</a>
                </div>
                <div class="_uIb">
                    <span id="swml_lmsep">&nbsp;-&nbsp;</span>
                    <a href="#">了解详情</a>&nbsp;&nbsp;&nbsp;
                </div>
            </div>

            <div class="f-nav">
						<span class="_nW ">
							<span id="#fsl ">
								
							</span>
						</span>
                <a href="">帮助</a>
                <a href="">发送反馈</a>
                <a href="">隐私权</a>
                <a href="">条款</a>
            </div>
        </div>

    </div>
</div>


</body>
</html>
<script src="/static/js/bootstrap-paginator.min.js"></script>

<script type="application/javascript">
    var total_num = 0
    function GetQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null)return unescape(r[2]);
        return null;
    }
    function replaceParamVal(oldUrl, paramName, replaceWith) {
        var re = eval('/(' + paramName + '=)([^&]*)/gi');
        var nUrl = oldUrl.replace(re, paramName + '=' + replaceWith);
        return nUrl;
    }
    function search(kw, pagecount, pageNum) {
        $.ajax({
            type: 'POST',
            url: "/v1/search",
            sync: true,
            data: {kw: kw, from: pagecount, pagenum: pageNum},
            success: function (data) {
                $(".srh-list-data-body").empty()
                $("#res_total_count").text("0")
                $("#res_max_score").text("0")
                if (data && data.ret == "0" && data.total_count != 0) {

                    $("#res_total_count").text(data.total_count)
                    $("#res_max_score").text(data.data.max_score)
                    total_num = data.total_count


                    var array_hits = data.data.hits
                    for (
                        var k = 0, length = array_hits.length;
                        k < length;
                        k++
                    ) {
                        var link = array_hits[k]._source["link"]
                        if (link.length > 71) {
                            link = link.substring(0, 70)
                        }

                        var list_item = '<div class="list-data-show"><h3>' +
                            '<a href="' + array_hits[k]._source["link"] + '" target="_blank">' + $.trim(array_hits[k]._source["title"]).replace(/&nbsp;/ig, '').replace(/[\r\n]/g, "") + '</a></h3> <div class="list-address"> <cite class="adr">' + link + '</cite> <div class="list-arrow"> <a href="#"> <span></span> </a> </div> <a class="trs" href="#">匹配度：' + array_hits[k]._score + '</a> </div> <span class="abs">' + $.trim(array_hits[k]._source["desc"]).replace(/&nbsp;/ig, "").replace(/[\r\n]/g, "") + '</span> </div>'
                        $(".srh-list-data-body").append(list_item)
                    }


                }
            }

        });


    }


    function init_search(kw) {

        total_num=0
        $.ajax({
            type: 'POST',
            url: "/v1/search",
            sync: true,
            data: {kw: kw, from: 0, pagenum: 10},
            success: function (data) {
                $(".srh-list-data-body").empty()
                $("#res_total_count").text("0")
                $("#res_max_score").text("0")
                if (data && data.ret == "0" && data.total_count != 0) {

                    $("#res_total_count").text(data.total_count)
                    $("#res_max_score").text(data.data.max_score)
                    total_num = data.total_count;
                    debugger;
                    init_page();


                    var array_hits = data.data.hits
                    for (
                        var k = 0, length = array_hits.length;
                        k < length;
                        k++
                    ) {
                        var link = array_hits[k]._source["link"]
                        if (link.length > 71) {
                            link = link.substring(0, 70)
                        }

                        var list_item = '<div class="list-data-show"><h3>' +
                            '<a href="' + array_hits[k]._source["link"] + '" target="_blank">' + $.trim(array_hits[k]._source["title"]).replace(/&nbsp;/ig, '').replace(/[\r\n]/g, "") + '</a></h3> <div class="list-address"> <cite class="adr">' + link + '</cite> <div class="list-arrow"> <a href="#"> <span></span> </a> </div> <a class="trs" href="#">匹配度：' + array_hits[k]._score + '</a> </div> <span class="abs">' + $.trim(array_hits[k]._source["desc"]).replace(/&nbsp;/ig, "").replace(/[\r\n]/g, "") + '</span> </div>'
                        $(".srh-list-data-body").append(list_item)
                    }


                }
            }

        });
    }


    // 调用方法
    $(function () {


        var kw = GetQueryString("kw")
        if (kw == null) {
            return
        }
        else {
            kw = decodeURIComponent(kw)
            $("#txtsearch_box").val(kw)
            init_search(kw)
        }


        $("#txtsearch_box").bind('keydown', function (event) {
            if (event.keyCode == "13") {
                if ($("#txtsearch_box").val() != "") {
                    search_kw()
                }
            }
        });
        $("#btn_search").click(function () {
            if ($("#txtsearch_box").val() != "") {
                search_kw()
            }
        })
    })

    function search_kw() {
        var newUrl = replaceParamVal(window.location.href, "kw", encodeURIComponent(encodeURIComponent($("#txtsearch_box").val())))
        var stateObject = {}
        history.pushState(history.state, document.title, newUrl);

          init_search($("#txtsearch_box").val(), 0, 10)
    }


    function init_page() {
        debugger;
        total_page = Math.ceil(parseInt(total_num) / 10)
        if (total_num == 0) {
            total_page = 0
        }

        var numofPage = 5
        if (total_page<=5)
            numofPage=total_page

        var options = {
            bootstrapMajorVersion: 3,
            currentPage:1,
            numberOfPages: numofPage,
            totalPages: total_page,
            itemTexts: function (type, page, current) {
                switch (type) {
                    case "first":
                        return "First";
                    case "prev":
                        return "Previous";
                    case "next":
                        return "Next";
                    case "last":
                        return "Last";
                    case "page":
                        return page;
                }
            },
            onPageClicked: function (e, originalEvent, type, page) {
                if (parseInt(page) == 0) {
                    search($("#txtsearch_box").val(), 0, 10)
                }
                else {
                    search($("#txtsearch_box").val(), parseInt(page) * 10-10, 10)
                }


            }
        }


        $('#page-navigation').bootstrapPaginator(options);
    }

</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?1a9ae341a6480a6887940f455f8d9c07";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

